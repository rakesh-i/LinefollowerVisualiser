<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Linefollower</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.3.2"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@1.27.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon@1.0.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-streaming@2.0.0"></script>
</head>
<body>
    <header>
        <div id="ipcont">
             <input type="text" name="ip" id="ipAddress" placeholder="Enter IP Address" value="192.168.0.100" >
            <button id="toggleButton">Connect</button>
        </div>
        <div id="pages">
            <div id="rc" class="tabs">
                Remote
            </div>
            <div id="pid" class="tabs">
                PID
            </div>
            <div id="motor" class="tabs">
                Motor
            </div>
            <div id="turn" class="tabs">
                Turn
            </div>
            <div id="maze" class="tabs">
                Maze
            </div>
            <div id="debug" class="tabs">
                Debug
            </div>
        </div>
        <div id='stcont'>
            <div id="status" class="idle">
                <img src="svg/disconnected.svg" alt="" height="24" width="24">
            </div>
        </div>
    </header>
    <div id="content" >
        <div id="rcPage" class="tabPage" style="display: none;">
            <div id="rcCont">
                <div>REMOTE CONTROL</div>
                <button id="manMode" >Manual Mode OFF</button>
                <div id="speedCont">
                    <label for="speed">Speed:</label>
                    <input type="range" id="speed" min="0" max="255" value="70" >
                    <span id="speedVal">70</span>
                </div>
                

                <div class="arrow-buttons">
                    <button class="arrow up" data-direction="forward" id="btn-up"></button>
                    <div>
                        <button class="arrow left" data-direction="left" id="btn-left"></button>
                        <button class="arrow right" data-direction="right" id="btn-right"></button>
                    </div>
                    <button class="arrow down" data-direction="backward" id="btn-down"></button>
                </div>
            </div>
        </div>
        <div id="motorPage" class="tabPage" style="display: none;">
            <h1>MOTOR TEST</h1>
            <div>
                <input type="number" name="en1" id="en1" step="5" value="0">
                <label for="en1">ENCODER 1</label>
            </div>
            <div>
                <input type="number" name="en2" id="en2" step="5" value="0">
                <label for="en2">ENCODER 2</label>
            </div>
            <div>
                <input type="number" name="ms" id="ms" step="50" value="100" min="50">
                <label for="ms">LOOP TIME</label>
            </div>
            <button id="encoderMove" >MOVE</button>
        </div>
        <div id="pidPage" class="tabPage" style="display: none;">
            <div id="pidCont">
                <div>PID TEST</div>
                    <div id="pidVal">
                        <div id="pidValCol1">
                            <div>
                                <input type="number" name="speedr" id="speedr" step="5" value="50" min="0">
                                <label for="speedr">SPEED</label>
                            </div>
                            <div>
                                <input type="number" name="KP" id="kp" step="0.1" value="0" min="0">
                                <label for="kp">KP</label>
                            </div>
                            <div>
                                <input type="number" name="KD" id="kd" step="0.1" value="0" min="0">
                                <label for="kd">KD</label>
                            </div>
                            <div>
                                <input type="number" name="KI" id="ki" step="0.0001" value="0" min="0">
                                <label for="ki">KI</label>
                            </div>
                            <div>
                                <input type="number" name="mxspeed" id="mxspeed" step="5" value="50" min="0">
                                <label for="mxspeed">CORRECTION SPEED</label>
                            </div>
                        </div>
                        <button id="setPid" >SET</button>
                    </div>
                    <div id="calBox">
                        <div>
                            <input type="number" name="calSpeed" id="calSpeed" step="5" value="50" min="0">
                            <label for="calSpeed">Calibration Speed</label>
                        </div>
                        <div>
                            <input type="number" name="calTime" id="calTime" step="10" value="100" min="100">
                            <label for="calTime">Calibration Time</label>
                        </div>
                        <button id="calibrate">Calibrate</button>
                    </div>
                   
                    <button id="race">Race</button>
                    <h1>IR Sensor Data</h1>
                    <canvas id="gridCanvas" width="500" height="500"></canvas>
                    <div id="raw">
                        <div id="ir1"></div>
                        <div id="ir2"></div>
                        <div id="ir3"></div>
                        <div id="ir4"></div>
                        <div id="ir5"></div>
                    </div>
                    <div style="display: none;">
                        <div class="encvalue">
                            <div>
                                <p>Original Encoder 1: <span id="Encoder1">0</span></p>
                                <p>Original Encoder 2: <span id="Encoder2">0</span></p>
                            </div>
                            <div>
                                <p>Current Encoder 1: <span id="curE1">0</span></p>
                                <p>Current Encoder 2: <span id="curE2">0</span></p>
                            </div>
                        </div>
                        
                        <div id="canvasContainer">
                            <canvas id="canvas"></canvas>
                        </div>
                        <div id="controls">
                            <button id="clearButton">Clear</button>
                            <button id="exportButton">Export as JPEG</button>
                        </div>
                </div>
            </div>
            
        </div>

        <div id="turnPage" class="tabPage" style="display: none;">
        </div>

        <div id="mazePage" class="tabPage" style="display: none;">
            <h1>MAZE</h1>
            <button id="mazeEx" >Explore</button>
            <button id="shortest" >Shortest path</button>
        </div>
        <div id="debugPage" class="tabPage", style="display: none;">
            <h2>WebSocket Message Frequency Monitor</h2>
            <p>Messages received: <span id="messageCount">0</span></p>
            <p>Frequency: <span id="frequency">0</span> messages/second</p>
        </div>
    </div>
</body>
</html>